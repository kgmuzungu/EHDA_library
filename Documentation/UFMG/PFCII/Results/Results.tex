\chapter{Results}
\label{chap:Results}

This chapter will present the results obtained from this project. 
Firstly, it will be demonstrated how the automation routine enhanced the research experiments. 
Next, a discussion on the validation of the classification results. 
Finally, a showcase of performance on the implemented controller algorithms.

\section{Automation routine}
\label{sec:automation_routine}

The automated experiment routine is capable of acquiring a significantly more precise and extensive amount of data than what can be achieved by a human. 
It was achieved less program memory during the experiment and, specially, safety for not losing data in case the program fail during an experiment with the usage of json streams in the saving thread.

Also, most power supplies rely on manual potentiometer adjustment to select the set point, which results in imprecise potential selection by a person, and it takes some time to achieve the desired voltage.
Moreover, the electrospray phenomena has a known hysteresis, that can be seen in figure \ref{fig:ganan_calvo_fig}, and can perform different results depending on the previous electric potential.
Running a computer routine that automatically sends commands to the power supply and pump machine allowed obtaining faster and more reliable experiment data points.

The visual interface for the user, seen in figure \ref{fig:multi_class_exp1}, shows all the important sensor data and signal analysis that can be interesting to the operator in real time, serving as a supervisory system.

\begin{figure}[H]
    \center
    \includegraphics[width=16cm]{Figuras/19:03/axs1.png}
    \caption{Print screen of the window shows user interface during the experiment.
        The image generated by the high speed camera can be seen in the background.
        The routine code running in pycharm software on the right side.
        And also real time signal plotting of the current data on the left side.}
        \label{fig:multi_class_exp1}
\end{figure}


\section{Classification}
\label{sec:classification_results}

The classification results in the algorithm implemented as described in section \ref{sec:section_classification} showed high accuracy for all the classifications described in section \ref{sec:spraying_modes_subsec}.
Nevertheless, the multi jet classification made by a current value factor of 1.14 above the cone jet is just effective for pure ethanol, liquid used in all this project.

Even if the multi jet classification just works for pure ethanol, the data saved with correct classification for ethanol can be used to extract any other signal information about the multi jet or to train a black box classification algorithm.

The classification result will be categorized into two main groups - the step routine and the map routine. These two routines have showed valuable insights and comprehensible results of the electrospraying process.


\subsection{Step Sequence}
\label{subsec:step_results}

The first classification results were made exploring the voltage ranges. 
For that the setup file was configured to run a step routine with a fixed flow rate of 0.7 uL/min., as defined in \ref{subsec:step_routine}. 

The figure \ref{fig:step_class} shows three graphs. 
The first is about the controller output signal as an input voltage of the process. As it is a step routine, an increasing voltage with steps sizes of 50V and time between each step of 5 seconds was implemented. The voltage range is between 3k-10k Volts.

The second is the raw output data collected by the oscilloscope in \emph{data\_acquisition\_thread()}. 
The sampling rate is 100kHz. Therefore, this experiment of 700s has 70 Million data points just of current data. 
This is an example of how scalable the data collected can be depending on the experiment time. This will be even more noticeable in mapping experiments.

The Third graph is the same data as the second after the classification procedure done by \emph{data\_processing\_thread()}. 


\begin{figure}[H]
    \center
    \includegraphics[width=16cm]{Figuras/may/step_class.png}
    \caption{Automatic electrospray classification through the step routine.}
    \label{fig:step_class}
\end{figure}

The graph of voltage scan has a common shape for different liquids and parameters. After having familiarity with it, is even possible to classify the spraying modes by visual analysis. 

For example, dripping mode has a current mean of 0V. The Intermittent state have a high variation of values that can be seen by the increased thickness on the graph. The cone jet is a thinner graph because of its constant signal. Multi Jet  has the same shape as cone jet but with a higher mean value. Corona sparks are not showed in the graph because its discharges has a high current value above the axis limits.



\subsection{Map Sequence}
\label{subsec:map_results}

For validation with literature and also to expose the benefits of the automated routine and classification, the map sequence proof itself the best result of this work. 
Initially, for better understanding of pure ethanol classification regions through voltage and flow rate ranges, a manual map was made, as seen in figure \ref{fig:stability_1}.

    \begin{figure}[H]
        \center
        \includegraphics[width=12cm]{Figuras/regions.png}
        \label{fig:stability_1}
        \caption{Experimental spraying modes regions of pure ethanol.}
    \end{figure}


    In order to validate the automatic classification, experiments were made comparing both visual and automatic stability island on the same experiment.
    figure \ref{fig:stability_2} shows that automatic stable cone jet region could be identified in the same region as visually seen by the high speed camera (data acquired manually).

        \begin{figure}[H]
            \center
            \includegraphics[width=16cm]{Figuras/april/manual_stability_island.png}
            \caption{Cone jet stability region for pure ethanol experiment 1.}
            \label{fig:stability_2}
        \end{figure}


    With the development of a multi jet classification using the logic explained in section \ref{sec:section_classification}, the same experiment was repeated, as shown in figure \ref{fig:stability_6}.

        \begin{figure}[H]
            \center
            \includegraphics[width=18cm]{Figuras/april/map_third.png}
            \caption{Cone jet stability region for pure ethanol experiment 2.}
            \label{fig:stability_6}
        \end{figure}

    For a better comparison with literature, specifically the Ga침치n-Calvo\cite{gananCalvo} stability islands shapes showed in figure \ref{fig:ganan_calvo_fig}, a visual juxtaposition of the same data in figure \ref{fig:stability_6} was displayed in figure \ref{fig:stability_8} using the non-dimensional numbers of potential and flow rate on the axis.

        \begin{figure}[H]
            \center
            \includegraphics[width=18cm]{Figuras/april/manual_au_1.png}
            \caption{Cone jet island manual experiment 4.}
            \label{fig:stability_8}
        \end{figure}

        The holes of data in figure \ref{fig:stability_8} is because of the logarithmic scale in the x-axis. 
        To fill the graph and compare with literature the behavior of the cone jet island while increasing the conductivity, other 3 experiments with different conductivities solutions of ethanol were done with help of a PhD in chemical engineering, L. P. Di Bonito.
        Each graph in figure \ref{fig:conductivity_test} took around 5 hours of experiment and 20 GB of data stored. 
        
        While increasing conductivity, the cone jet stability region changes its shape and slightly moves to the right, as demonstrated by Ga침치n-Calvo in figure \ref{fig:ganan_calvo_fig}.
        The multi jet classification was not considered in these experiments and were classified as 'Undefined' because the classification rule defined in this project works just for pure ethanol.

        \begin{figure}[H]
            \center
            \includegraphics[width=18cm]{Figuras/may/conductivity_test.png}
            \caption{Mapping experiment for different conductivities of ethanol solution.}
            \label{fig:conductivity_test}
        \end{figure}


    The results of automatic mapping experiment corresponded manually and with literature the regions of classification, validating the method.


\section{Controller}
\label{sec:controller_results}

    The results of the classification process were favorable for experiment automation, however, the inaccuracy of the classification by statistical methods, specially the Multi Jet \ref{subsec:Multi Jet}, limited the development of a complete control project.
    Together with the amount of variables that need to be adjusted it is hard to stabilize in a desired mode.
    Even with all those problems, a simple controller project could be implemented, as described in section \ref{sec:control_model}, that validated the efforts of remodeling all software into a closed loop control model.
    
    The controller not only stabilized in cone jet mode, but also could reject perturbation, as seen in figure \ref{fig:control_results}, where the flow rate was manually changed.
    First graph shows the raw current acquired during this experiment.
    The second graph shows a voltage graph where it can be seen the controller actuating increasing the voltage to achieve a stable cone jet mode.
    The third graph shows the mean value of each sample colored representing its automatic classification.
    
    At the beginning, the system starts up with initial voltage of 4500 V, being classified as intermittent state, defined by an oscillating signal in first graph and blue samples in third graph. 
    The controller then, automatically actuates increasing the voltage to reach the stable cone jet. 
    After a period of stability, it was done a manual increase in the flow rate, serving as a perturbation of the system, and it can be seen that the effect of that was to return to intermittent state with the oscillating signal. 
    The controller again, actuates by increasing the voltage to reach the cone jet stability island. 
    This procedure was repeated after some seconds of stabilization in cone jet, increasing once more the flow rate manually, and again the system automatically adjusted the voltage.
    
    \begin{figure}[H]
            \center
            \includegraphics[width=16cm]{Figuras/19:03/control_first_results.png}
            \caption{Simple controller validation with manual perturbations in flow rate.}
            \label{fig:control_results}
        \end{figure}

    After 200 seconds of experiment the system had some breaks up of the cone jet into a droplet and stabilized again, represented by the peak values in current signal. In this case the classification correctly identified as intermittent because of its signal shape, seen as blue dots in the third graph, but the controller reacted increasing the voltage in a situation that can be considered as noise because it was a small period of instability inside the stability region that could be a result of other external perturbation such as a bubble in the liquid line. A filter can be applied in a more complex controller project to avoid this.
    


\section{Chapter conclusion}

In this chapter the results of this project were exposed. The automatic routine, real time classification and control were all achieved and implemented. However, they can all be improved. Next Chapter will conclude this document with discussions about the results and proposal of continuation.


\clearpage